# 연속체의 지배 방정식
## 운동 방정식
운동하는 연속체에 Euler의 운동방정식과 Euler-Cauchy stress principle을 적용하면 다음과 같다.
$$ \int_{\partial\Omega} \boldsymbol{\sigma}\mathbf n \thinspace dS + \int_\Omega \rho \mathbf f_b \thinspace dV = \frac{d}{dt} \int_\Omega \rho\mathbf u \thinspace dV $$

$\boldsymbol{\sigma}$가 충분히 매끄러울 때, divergence theorem과 Reynolds transport theorem을 적용하여 유도한 미분형 지배방정식은 다음과 같다.
$$ \text{find} \enspace \mathbf d \in \mathcal D^3 \quad s.t. \quad \mathrm{div}(\boldsymbol\sigma) + \rho \mathbf f_b = \frac{\partial}{\partial t}(\rho \mathbf u) + \mathrm{div}(\rho \mathbf{u \otimes u}) $$
$$ \text{Where, } \mathcal{D} := \{ d_i \in C^2(\Omega) \enspace | \enspace d_i \text{ satisfies boundary condition on } \partial\Omega\}  $$

## 평형 방정식
정적 평형 상태의 연속체에 Euler의 운동방정식과 Euler-Cauchy stress principle을 적용하면 다음과 같다.
$$ \int_{\partial\Omega} \boldsymbol{\sigma}\mathbf n \thinspace dS + \int_\Omega \rho \mathbf f_b \thinspace dV = 0 $$

여기서, $\mathbf f_b$는 단위 질량당 체적력을 의미한다.

$\boldsymbol{\sigma}$가 충분히 매끄러울 때, divergence theorem을 적용하여 유도한 미분형 지배방정식은 다음과 같다.
$$ \text{find} \enspace \mathbf d \in \mathcal D^3 \quad s.t. \quad \mathrm{div}(\boldsymbol\sigma) + \rho \mathbf f_b = 0 $$
$$ \text{Where, } \mathcal{D} := \{ d_i \in C^2(\Omega) \enspace | \enspace d_i \text{ satisfies boundary condition on } \partial\Omega\}  $$

> 참고  
> 연속체 역학 정리.md

# 지배 방정식의 풀이

## 평형 방정식의 풀이

### Weak formulation
3개의 평형방정식의 주어진 식(1)을 equivalent한 weak formulation으로 바꾸기 위해 test vector function $\mathbf w$와 내적한뒤 다음과 같은 과정을 거친다.
$$ \begin{equation} \begin{gathered} \int_{\Omega} ( \mathrm{div}(\boldsymbol\sigma) + \mathbf {f ) \cdot w} dV  = 0. \\\\ \int_{\Omega} \mathrm{div}(\boldsymbol\sigma  \mathbf {w}) - \boldsymbol\sigma : \boldsymbol{\epsilon}  + \mathbf {f \cdot w} dV  = 0. \\\\ \int_{\Omega} \boldsymbol\sigma : \text{grad}(\mathbf w) dV = \int _{\partial\Omega} \boldsymbol\sigma  \mathbf {w \cdot n} dS + \int _{\Omega} \mathbf {f \cdot w} dV \\\\ \int_{\Omega} \boldsymbol\sigma : \text{grad}(\mathbf w) dV = \int _{\partial\Omega} \mathbf t \cdot \mathbf w dS + \int _{\Omega} \mathbf {f \cdot w} dV \end{gathered} \end{equation} $$

이 때, $\boldsymbol\sigma : \text{grad}(\mathbf w)$항은 $\boldsymbol{\sigma}$의 symmetry에 의해 다음과 같이 표현할 수 있다.
$$ \boldsymbol\sigma : \text{grad}(\mathbf w) = \boldsymbol\sigma_v \cdot \delta \mathbf w $$
$$ \text{Where, } \boldsymbol\sigma_v = \begin{bmatrix} \sigma_{11} \\ \sigma_{22} \\ \sigma_{33} \\ \sigma_{23} \\ \sigma_{13} \\ \sigma_{12} \end{bmatrix}, \enspace \delta \mathbf w = \begin{bmatrix} \frac{\partial w_1}{\partial x_1} \\ \frac{\partial w_2}{\partial x_2} \\ \frac{\partial w_3}{\partial x_3} \\ \frac{\partial w_2}{\partial x_3} + \frac{\partial w_3}{\partial x_2}  \\ \frac{\partial w_1}{\partial x_3} + \frac{\partial w_3}{\partial x_1} \\ \frac{\partial w_1}{\partial x_2} + \frac{\partial w_2}{\partial x_1} \end{bmatrix} $$

고체의 constitutive equation과 strain-displacement 관계식을 이용하면 다음과 같다.
$$ \boldsymbol\sigma_v = \mathbf C \mathbf \partial \mathbf d, \quad \delta \mathbf w = \mathbf \partial \mathbf w  $$

결론적으로 유도된 weak formulation은 다음과 같다.
$$ \begin{equation} \text{find} \enspace \mathbf d \in (\mathcal D_W)^3 \quad s.t. \quad \forall \mathbf w \in \mathcal W^3, \quad \int_{\Omega} \mathbf C \mathbf \partial \mathbf d \cdot \mathbf \partial \mathbf w dV = \int _{\partial\Omega} \mathbf t \cdot \mathbf w dS + \int _{\Omega} \mathbf {f \cdot w} dV \end{equation} $$
$$ \begin{aligned} \text{Where, } \mathcal{D}_W &:= \{ d_i \in C^1(\Omega) \enspace | \enspace d_i \text{ satisfies boundary condition on } \partial\Omega_E \}  \\ \mathcal W &:= \{ w \in C^\infty(\Omega) \enspace | \enspace \forall \mathbf x \in \partial\Omega_E, \quad w(\mathbf x) = 0 \ \end{aligned}  $$

> Q. test vector function과 내적한 식의 해가 연립방정식의 해와 동일한가?

### Ritz method
weak formulation을 수치적으로 풀기 위해 Ritz method를 사용한다. solution function space의 기저 함수로 shape function을 사용하면 solution과 weight vector를 각 각 $\mathbf d = \mathbf{N\hat{d}}, \mathbf w = \mathbf{N} \boldsymbol{\delta}$ 표현할 수 있고 문제가 다음과 같이 간단해진다.
$$ \begin{equation} \text{find} \enspace \hat {\mathbf d} \in \R^{3n} \quad s.t. \quad \forall \boldsymbol \delta \in \R^{3n}, \quad \int_{\Omega} \mathbf C \mathbf B \hat {\mathbf d} \cdot \mathbf B \boldsymbol \delta dV = \int _{\partial\Omega} \mathbf t \cdot \mathbf{N} \boldsymbol{\delta} dS + \int _{\Omega} \mathbf f \cdot \mathbf{N} \boldsymbol{\delta} dV \end{equation} $$

위 식을 다음과 같이 정리할 수 있다.
$$ \begin{aligned} & \int_{\Omega} \mathbf C \mathbf B \hat {\mathbf d} \cdot \mathbf B \boldsymbol \delta dV = \int _{\partial\Omega} \mathbf t \cdot \mathbf{N} \boldsymbol{\delta} dS + \int _{\Omega} \mathbf f \cdot \mathbf{N} \\ \Leftrightarrow \enspace &  \boldsymbol \delta^T \left( \left( \int_{\Omega} \mathbf B^T \mathbf C \mathbf B \thinspace dV \right) \hat {\mathbf d} - \int _{\partial\Omega} \mathbf N^T \mathbf t \thinspace dS - \int _{\Omega} \mathbf N^T \mathbf f \thinspace dV \right) = 0 \end{aligned} $$

임의의 $\boldsymbol \delta$에 대해서 위 식이 성립해야 됨으로 문제가 다음과 같이 간단해진다.
$$ \text{find} \enspace \hat {\mathbf d} \in \R^{3n} \quad s.t. \quad \mathbf K \hat {\mathbf d} = \mathbf f  $$
$$ \text{Where, } \mathbf K = \int_{\Omega} \mathbf B^T \mathbf C \mathbf B \thinspace dV, \enspace \mathbf f = \int _{\partial\Omega} \mathbf N^T \mathbf t \thinspace dS + \int _{\Omega} \mathbf N^T \mathbf f \thinspace dV $$

이 방법은 `가상 일 원리(principle of virtual work)`라고도 한다. $\bf w$를 `가상 변위(virtual displacement)` $\delta \mathbf d$로 보면 식(2)는 다음과 같다.
$$ \text{find} \enspace \mathbf d \in (\mathcal D_W)^3 \quad s.t. \quad \forall \mathbf \delta \mathbf d \in \mathcal W^3, \quad \int_{\Omega} \boldsymbol\sigma \cdot \delta \boldsymbol{\epsilon} dV = \int _{\partial\Omega} \mathbf t \cdot \delta \mathbf d dS + \int _{\Omega} \mathbf f \cdot \delta \mathbf d dV $$

좌측항은 물리적으로 `내부 가상 일(internal virtual work)`, 우측항은 `외부 가상 일(external virtual work)`로 볼 수 있기 때문에 가상 일 원리라고 한다.

> 참고  
> [note] (Abaqus) Equilibrium and virtual work  
> Weighted Residual Methods.md  

# Compatibility condition
미소 변위이론에 따른 변형률-변위 관계식은 다음과 같다.
$$ \epsilon_{ij} = \frac{1}{2} \left( \frac{\partial d_i}{ \partial x_j } + \frac{\partial d_j}{ \partial x_i } \right) $$

따라서 미소 변위이론에 따른 변형률-변위 관계식을 만족하는 경우 다음과 같이 주어진 `compatibility condition`을 만족해야 한다.

$$\begin{gathered} \frac{\partial^2 \epsilon_{ii}}{ \partial (x_j)^2 } + \frac{\partial \epsilon_{jj}}{ \partial (x_i)^2 } = 2 \frac{\partial^2 \epsilon_{ij}}{ \partial x_i \partial x_j } \\ (i,j) = \{(1,2), (1,3), (2,3)\} \\ \text{(it's not a summation}) \end{gathered} $$

따라서, 변형률-변위 관계식을 통해서 변형률을 구할 경우 compatibility condition을 반드시 만족한다. 

만약 변형률-변위 관계식을 통해서 변형률을 구하지 않은 경우 compatibility condition을 확인함으로써 변형률-변위 관계식을 만족하는지 알 수 있다.

# 등매개변수 요소
기하학적 형태(좌표)를 보간할 때와 변위를 보간할 때 같은 형상함수를 사용할 경우 `등매개변수 보간(isoparametric interpolation)`이라고 한다.

# 근사 해
등매개변수 요소에서 $N_p$개 점의 변위벡터 $\bf d$를 근사하게 되면 다음과 같다.
$$ \mathbf {d = N d}_e \\ \bf d_e \in \R^{d \times N_p}, \quad \dim(N)= $$

공학 변형률 벡터와 변위 관계에 대입하면 다음과 같다.
$$ \boldsymbol \epsilon = \mathbf {Bd}_e  \\ \text{where,} \quad \bf B = \partial n $$

$\bf B$를 변형률-변위 행렬이라고 한다.

일반화된 후크의 법칙을 이용해 응력을 구하면 다음과 같다.
$$ \boldsymbol \sigma = \mathbf {EBd}_e $$

위에서 구한 관계식들을 가상 일 원리에 대입하면 다음과 같다.
$$  \mathbf {K d}_e = \mathbf r_e  \\ \mathbf K = \mathbf {\int B^TEB} dV, \quad \mathbf r_e = \int \mathbf {N^Tb} dV + \int \mathbf {N^Tt} dS $$

# 보간
## $C^0$ 보간

### $\phi : \R \rightarrow \R$
함수 $\phi : \R \rightarrow \R$를 $n$개의 `단항식(monomial)`을 갖는 `다항식(polynomial)`으로 근사하면 다음과 같이 표현할 수 있다.
$$ \phi(x) \approx \mathbf a \cdot \mathbf m(x) $$

이 떄, 서로 다른 $n$개의 $x_i$에서 $\phi(x_i)$값을 알고 있다면 $\phi(x_i) = \mathbf a \cdot \mathbf m(x_i)$를 만족하도록 $\mathbf a$를 결정할 수 있다.

위의 조건을 행렬 형태로 나타내면 다음과 같다.
$$ \boldsymbol{\hat{\phi}} = \mathbf M^T \mathbf a \\ \text{where,} \quad \mathbf M =  \begin{bmatrix} \mathbf m(x_1) & \cdots & \mathbf m(x_n) \end{bmatrix}, \quad \hat{\phi}_i = \phi(x_i) $$

따라서 $\bf a = (M^T)^{-1} \boldsymbol{\hat{\phi}}$이고 이를 원래 식에 대입하면 다음과 같다. 
$$ \begin{aligned} \phi &= \mathbf {a \cdot m} \\ &= \mathbf {m \cdot a} \\ &= \mathbf m^T (\mathbf M^T)^{-1} \boldsymbol{\hat{\phi}} \\ &= \mathbf n \cdot \boldsymbol{\hat{\phi}} \quad  \end{aligned} $$

이 때, $\mathbf n = \mathbf M^{-1} \mathbf m$은 형상함수 벡터이고 $n_i$는 다음과 같은 Lagrange 다항식 형태로 주어진다.

$$ n_i = \prod_{\substack{j = 1 \\ j \neq i}}^n \frac{x_j - x}{x_j - x_i} $$

이와 같이 각 점에서 값을 만족하게 보간하는 방법을 `라그랑지 보간(Lagrangian interpolation)`이라고 한다.

### $\boldsymbol{\phi} : \R^d \rightarrow \R^r$
함수 $\boldsymbol{\phi} : \R^d \rightarrow \R^r$를 $n$개의 단항식을 갖는 다항식으로 근사하면 다음과 같이 표현할 수 있다.

$$ \boldsymbol{\phi}\mathbf{(x)} = \mathbf {Am(x)} \\ \mathbf A \in \R^{r \times n}$$

이 때, 서로 다른 $n$개의 $\mathbf x_i$에서 $\boldsymbol{\phi}(\mathbf x_i)$ 값을 알고 있다면 $\boldsymbol{\phi}(\mathbf x_i) = \mathbf {Am(x}_i)$를 만족하도록 $\bf A$를 결정할 수 있다. 

$\boldsymbol{\phi}$의 $i$번째 원소 $\phi_i$는 다음과 같이 표현된다.
$$ \begin{equation} \phi_i(\mathbf x) = \mathbf A_{i*} \cdot \mathbf m(\mathbf x) \end{equation} $$

$i$번째 원소가 만족해야 하는 조건을 행렬 형태로 나타내면 다음과 같다.
$$ \hat{ \boldsymbol \phi_i} = \mathbf M^T \mathbf A_{i*} \\ \text{where,} \quad \mathbf M =  \begin{bmatrix} \bf m(x_1) & \cdots & \bf m(x_n) \end{bmatrix}, \quad \hat{\phi}_{i,j} = \phi_i(\mathbf x_j)$$

따라서 $\mathbf A_{i*} = (\mathbf M^T)^{-1} \hat{ \boldsymbol \phi_i}$이고 식(5)에 대입하면 다음과 같다.

$$ \begin{aligned} \phi_i &= \mathbf A_{i*} \cdot \mathbf m \\ &= \mathbf m \cdot \mathbf A_{i*} \\ &= \mathbf m^T (\mathbf M^T)^{-1} \boldsymbol{\hat{\phi}}_i \\ &= \mathbf n \cdot \boldsymbol{\hat{\phi}}_i \end{aligned} $$

모든 원소가 만족해야 하는 조건은 다음과 같다.
$$ \phi_i = \sum_{j=1}^n n_j\hat{\phi}_i(\mathbf x_j) \quad (i = 1, \cdots, r) $$

이를 하나의 행렬식으로 나타내면 다음과 같다.
$$ \boldsymbol{\phi} = \begin{bmatrix} n_1 \enspace \underbrace{0 \cdots 0}_{r-1}  && n_2 \enspace \underbrace{0 \cdots 0}_{r-1} && \cdots && n_n \enspace \underbrace{0 \cdots 0}_{r-1} \\ 0 \enspace n_1 \enspace \underbrace{0 \cdots 0}_{r-2} && 0 \enspace n_2 \enspace \underbrace{0 \cdots 0}_{r-2} && \cdots && 0 \enspace n_n \enspace \underbrace{0 \cdots 0}_{r-2} \\ && \qquad  \vdots \\ \underbrace{0 \cdots 0}_{r-1} \enspace  n_1 && \underbrace{0 \cdots 0}_{r-1} \enspace n_2 && \cdots && \underbrace{0 \cdots 0}_{r-1} \enspace n_n \end{bmatrix} \begin{bmatrix} \boldsymbol{\phi}(\mathbf x_1) \\ \vdots \\ \boldsymbol{\phi}(\mathbf x_r) \end{bmatrix} $$

$$ \boldsymbol{\phi} = \mathbf N \boldsymbol{\hat\phi} $$

#### 형상함수 성질
1. $$ \sum_i n_i = 1 $$
2. $$ n_i(x_j) = \delta_{ij} $$

2번 성질이 왜 만족할까?

## $C^1$ 보간

### $\phi : \R \rightarrow \R$
함수 $\phi : \R \rightarrow \R$를 $2n$개의 `단항식(monomial)`을 갖는 `다항식(polynomial)`으로 근사하면 다음과 같이 표현할 수 있다.
$$ \phi(x) \approx \mathbf a \cdot \mathbf m(x) $$

이 떄, 서로 다른 $n$개의 $x_i$에서 $\phi(x_i), \phi'(x_i)$값을 알고 있다면 $\phi(x_i) = \mathbf a \cdot \mathbf m(x_i)$와 $\phi'(x_i) = \mathbf a \cdot \mathbf m'(x_i)$를 만족하도록 $\mathbf a$를 결정할 수 있다.

위의 조건을 행렬 형태로 나타내면 다음과 같다.
$$ \boldsymbol{\hat{\phi}} = \mathbf M^T \mathbf a \\ \text{where,} \quad \mathbf M =  \begin{bmatrix} \mathbf m(x_1) & \mathbf m'(x_1) & \cdots & \mathbf m(x_n) & \mathbf m'(x_n) \end{bmatrix}, \quad \boldsymbol{\hat{\phi}} = \begin{bmatrix} \phi(x_1) \\ \phi'(x_1) \\ \vdots \\ \phi(x_n) \\ \phi'(x_n) \end{bmatrix} $$

따라서 $\bf a = (M^T)^{-1} \boldsymbol{\hat{\phi}}$이고 이를 원래 식에 대입하면 다음과 같다. 
$$ \begin{aligned} \phi &= \mathbf {a \cdot m} \\ &= \mathbf {m \cdot a} \\ &= \mathbf m^T (\mathbf M^T)^{-1} \boldsymbol{\hat{\phi}} \\ &= \mathbf n \cdot \boldsymbol{\hat{\phi}} \quad  \end{aligned} $$

이와 같이 각 점에서 값과 기울기 값을 만족하게 보간하는 방법을 `에르미트 보간(Hermitian interpolation)`이라고 한다.

# 선형 문제
`선형 문제(linear problem)`는 `물성치(material property)`가 변하지 않는 경우이다. 또한 변형이 충분히 작아 평형 방정식을 변형전 기하학적 형상에 적용할 수 있는 문제이다.

# 준 정적 해석
시간에 따라 변화가 없는 물체의 거동을 분석하는 것을 `정해석(static analysis)`이라고 한다. 반면, 시간에 따라 변하는 물체의 거동을 분석하는 것을 `동해석(dynamic analysis)` 이라고 한다. 예를 들어 고층 건물이 자체 무게에 의해 변형되는 량을 계산하는 것은 전자에 해당되며, 지진파에 따른 건물의 흔들림을 계산하는 것은 후자에 해당된다. 전자의 경우에는 물체의 속도 및 가속도에 따른 `관성력(inertia force)`이나 감쇠력이 없는 반면, 후자에 있어서는 이들이 중요하게 작용한다. 

만일 시간에 따라 변하는 물체의 거동에 미치는 관성력과 감쇠력의 영향이 무시할 수 있을 정도로 작다면 동해석을 정해석으로 단순화 시킬 수 있다. 이와 같이 동적인 영향을 무시하고 물체가 정적인 상태에 있다고 가정하여 정해석으로 단순화 시키는 것을 `준정적 해석(quasistatic analysis)`라고 한다.

## 참고
[준정적 해석이란? - 행복채움 블로그](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=zor991&logNo=221378508973)

# 강성 행렬

강성행렬의 $i$번째 열은 $i$번째 절점이 아닌 변위는 변하지 않고 $i$번째 절점의 변위만 1만큼 변하기 위해 필요한 힘과 같다.