헤더 파일은 다수의 소스 파일에 포함되어 컴파일될 수 있다. 이렇게 되면 중복된 작업으로 시간과 파일 크기가 증가하는 문제가 발생할 수 있다.

예를 들어 header.h가 a.cpp와 b.cpp에 포함된다고 해보자. 결국 컴파일러가 실제 처리하는 작업은 (header.h + a.cpp)와 (header.h + b.cpp)가 될 것이다. 이 때, header.h 부분을 처리하는데 많은 시간이 걸린다면 전체 작업은 2배로 늘어나게 될 것이고 더 많은 파일이 header.h를 포함할 수록 더 많은 시간이 걸리게 될것이다. 또한 header.h를 포함하는 각 소스 파일이 컴파일되어 나오는 목적 파일의 크기도 덩달아 커지게 된다.

당연히 중복되는 작업은 단 한번만 처리되도록 변경할 필요가 있으며 그래서 나온 것이 바로 미리 컴파일된 헤더이다.

header.h를 미리 컴파일된 헤더로 지정하게 될 경우 컴파일러는 header.h를 컴파일하여 컴파일된 정보를 만들게 된다. 그리고 header.h를 포함하는 소스 파일에 대해서 미리 컴파일된 헤더를 사용하도록 설정할 경우 해당 소스 파일을 컴파일할 때 header.pch(VC++ 컴파일러의 미리 컴파일된 헤더)를 가져와서 빠른 속도로 컴파일 한다.

미리 컴파일된 헤더는 소스 파일에 중복으로 포함되었을 때만 효과를 발휘하는 것은 아니다. 미리 컴파일된 헤더를 단 한 번만 만들어놓는다면 소스 파일을 컴파일하 때마다 헤더 파일을 처리하는 시간이 절약될 수 있다. 즉, 미리 컴파일된 헤더는 거의 변하지 않는 내용을 단 한번만 컴파일하여 재활용하는 것이라고 할 수 있다. 물론 전체 다시 빌드(rebuild all)를 선택할 경우 미리 컴파일된 헤더를 다시 생성하게 된다.


# 참고
김화수. (2015). Fundamental C++ 프로그래밍 원리 기초부터 고급까지.