# Nonlinear FEA Procedure
정적 평형 문제의 경우 지배방정식을 다음과 같은 Nonlinear algebraic equations으로 표현할 수 있다.
$$ R(\mathbf d) = 0 $$

$$ \text{Where, } R(\mathbf d) = \int_{\Omega} \mathbf B^T \boldsymbol\sigma_v \thinspace dV  - \int _{\partial\Omega} \mathbf N^T \mathbf t \thinspace dS - \int _{\Omega} \mathbf N^T \mathbf f \thinspace dV $$

이 떄, $R$을 residual이라고 부른다.

Nonlinear algebraic equations은 Newton-Raphson method를 이용해서 풀 수 있다.
1. 초기 해 $\mathbf d^0$를 예측하고 $n=0$으로 둔다.
2. $\mathbf d^n$에서 $R$를 선형근사한다.
$$ y= J_R(\mathbf d^n)(\mathbf d - \mathbf d^n) + R(\mathbf d^n) $$
3. 선형근사한 함수의 해 $\mathbf d^{n+1}$을 찾는다.
$$ \mathbf d^{n+1} = \mathbf d^n - J_R(\mathbf d^n)^{-1}R(\mathbf d^n)$$
4. $\mathbf d^{n+1}$이 수렴 조건을 만족하는지 확인한다.
$$ R(\mathbf d^{n+1}) \le \epsilon \enspace \land \enspace N \le n + 1  $$   
5. 만족하지 않는 경우 $n = n +1$로 두고 과정2로 돌아간다.



---

material nonlinearity만 고려하면 residual은 다음과 같이 간단해진다.
$$ R(\mathbf d) \approx \Big( \int_{\Omega} \mathbf B^T \mathbf D^{ep} \mathbf B \thinspace dV \Big) \mathbf d  - \int _{\partial\Omega} \mathbf N^T \mathbf t \thinspace dS - \int _{\Omega} \mathbf N^T \mathbf f \thinspace dV $$

Nonlinear algebraic equations은 Newton-Raphson method를 이용해서 풀 수 있다.
1. 초기 해 $\mathbf d^0$를 예측하고 $n=0$으로 둔다.
2. $\mathbf d^n$에서 $R$를 선형근사한다.
$$ y= J_R(\mathbf d^n)(\mathbf d - \mathbf d^n) + R(\mathbf d^n) $$

$$ J_R(\mathbf d) := \int_{\Omega} \mathbf B^T \mathbf D^{ep} \mathbf B \thinspace dV = \mathbf K_t $$
3. 선형근사한 함수의 해 $\mathbf d^{n+1}$을 찾는다.
$$ \mathbf d^{n+1} = \mathbf d^n - J_R(\mathbf d^n)^{-1}R(\mathbf d^n)$$
4. $\mathbf d^{n+1}$이 수렴 조건을 만족하는지 확인한다.
$$ R(\mathbf d^{n+1}) \le \epsilon \enspace \land \enspace N \le n + 1  $$   
5. 만족하지 않는 경우 $n = n +1$로 두고 과정2로 돌아간다.
