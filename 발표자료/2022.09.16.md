# 1D Stress-Strain Relation in Tension

<p align = "center">
<img src = "./image/2022.09.16_1.png">
</p>

* Yield stress를 넘어가면 plastic deformation을 한다.
* plastic deformation을 하면 영구변형이 남는다.
* Ultimate strength에 도달하기까지 strain hardening 현상이 나타난다.
* Ultimate strength에 도달 후 Fracture까지 strain-softening 현상이 나타난다.

# Elastoplastic Material Behavior Under Small Deformation
`Elastoplastic material`이란 elastic deformation과 plastic deformation이 전부 발생하는 재료다.

이 떄, small deformation상황에서 elastoplastic material을 modeling할 것이기 때문에 elastic과 strain hardening 현상만 모델링 한다.

## Hardening Model
<p align = "center">
<img src = "./image/2022.09.16_2.png">
</p>

### 공통점
* Yeild stress를 넘어가면 stress-strain의 기울기가 `tangent modulus` $E_t$가 된다.
  * 단순한 모델에서는 $E_t$가 상수이다. (strain-hardening 현상을 linear로 modeling 한다.)
* Strain-hardening 현상이 발생하면 yeild stress가 증가한다.
  * $b$점까지 loading한 후 unloading하면 $c$점이 되고 다시 loading을 가하면 yeild stress가 $b$점이 된다.
   
### 차이점
`인장-압축(tension-compression)`이 반복되는 cyclic loading이 발생하는 경우 yield stress를 어떻게 결정하는지에 따라 다른 hardening model을 사용한다.

#### Kinematic hardening model
* Elastic range가 initial yeild stress의 2배이다.
* Elastic range의 중심점이 원점을 지나고 기울기가 tangent modulus인 직선을 따라 움직인다.

##### 참고
Elastic range가 항상 initial yeild stress의 2배임으로 elastic range는 일정하다.

#### Isotropic hardening model
* Elastic range가 현재 yeild stress의 2배이다.
  * $|\sigma_b| = |\sigma_e|$이고 $|\sigma_f| = |\sigma_g|$이다.
* Elastic range의 중심점이 strain축을 따라 움직인다.
   
##### 참고
Plastic deformation이 발생할 때 마다 yeild stress가 증가함으로 elastic range도 증가한다.

## Strain
Elastoplastic material이 elastic deformation하면서 발생하는 strain을 elastic strain $\epsilon_e$, plastic deformation하면서 발생하는 strain을 plastic strain $\epsilon_p$라 하자.

Small deformation 가정에 의해 total strain $\epsilon$,$\epsilon_e$,$\epsilon_p$  사이에 다음 관계가 성립한다.
$$ \epsilon = \epsilon_e + \epsilon_p $$

$\epsilon_p$는 stress에 영향을 주지 않기 때문에, $\epsilon$이 주어지더라도 $\epsilon_e$가 얼마인지에 따라 stress가 다 달라진다. 따라서 elastoplastic material에서는 $\epsilon$만으로 stress를 구할 수 없다.

$\epsilon_p$는 재료가 항복할 때마다 축적됨으로, $\epsilon_p$를 계산하기 위해서는 모든 load increment에서 항복이 발생했는지 확인해야 한다. 이러한 특성을 `path(history) dependent`라고 한다.

## Plastic Modulus
Elastoplastic material이 plastic phase에 있을 때 strain increment $\Delta \epsilon$가 주어졌다고 하자.

이 떄, plastic modulus $H$를 다음과 같이 정의한다.
$$ H := \frac{\Delta \sigma}{\Delta \epsilon_p} $$

그러면 stress increment $\Delta \sigma$는 다음과 같다.
$$ \Delta \sigma = E \Delta \epsilon_e = E_t \Delta \epsilon = H\Delta \epsilon_p $$

### 명제1
Elastoplastic material이 plastic phase에 있을 때 strain increment $\Delta \epsilon$가 주어졌다고 하자.

다음을 증명하여라.
$$ \frac{1}{E_t} = \frac{1}{E} + \frac{1}{H} $$

#### 따름명제1
다음을 증명하여라.
$$ H = \frac{EE_t}{E-E_t} $$

#### 따름명제2
다음을 증명하여라.
$$ E_t = \frac{EH}{H + E} $$

### 명제2
Elastoplastic material이 plastic phase에 있을 때 strain increment $\Delta \epsilon$가 주어졌다고 하자.


다음을 증명하여라.
$$ \Delta \epsilon_p = \frac{\Delta \epsilon}{1 + H /E} $$

### 참고
명제1과 2는 Elastoplastic material이 plastic phase에 있는 상황에서 strain increment가 주어졌을 때 성립한다.

# FE Formulation for Elastoplasticity
incremental force method를 사용하고 $n$번째 load increment까지 해석이 완료되었다고 가정하자.

$n+1$번째 load increment에 대한 static structural equilibrium의 FE formulation은 다음과 같다.
$$ \int_\Omega B^T\sigma \thinspace dV - {}^{n+1}F = 0 $$

Material nonlinearity와 Small deformation이라 가정하면 다음과 같다.
$$ \Big( \int_\Omega B^T D^{ep}B \thinspace dV \Big) d - {}^{n+1}F = 0 $$

$R(d)$를 다음과 같이 정의한다.
$$R(d) := K_t d - {}^{n+1}F$$

$$ \text{Where, } K_t := \int_\Omega B^T D^{ep}B \thinspace dV $$

이 때, $K_t$를 `tangent stiffness matrix`라고 한다.

$R(d) = 0$을 풀기 위해 Newton-Raphson method를 적용한다.
1. 초기 값을 결정하고 $k=0$으로 둔다.
$$ {}^{n+1}d^0 = {}^{n}d $$   
2. 선형화 한뒤 해를 구한다.
$$ {}^{n+1}d^{k+1} = {}^{n+1}d^k - J_R({}^{n+1}d^k)^{-1} R({}^{n+1}d^k) $$
3. ${}^{n+1}d^{k+1}$이 convergence criterion을 만족하는지 확인한다.
$$ \lVert R({}^{n+1}d^{k+1}) \rVert \le \epsilon \enspace \land \enspace N \le k $$
4. convergence criterion을 만족하는 경우 ${}^{n+1}d = {}^{n+1}d^{k+1}$로 두고 algorithm을 종료한다. convergence criterion을 만족하지 않는 경우, $k = k+1$로 두고 step2로 돌아간다.

## Stress calculation
Newton-Raphson method의 step2를 보면 $R({}^{n+1}d^k)$를 계산해야 한다.
$$ \begin{aligned} R({}^{n+1}d^k) &= \Big( \int_\Omega B^T D^{ep}B \thinspace dV \Big) {}^{n+1}d^k - {}^{n+1}F \\&= \int_\Omega B^T ({}^{n+1}\sigma^k) \thinspace dV - {}^{n+1}F \end{aligned} $$

${}^{n+1}F$는 주어진 값임으로, displacement가 ${}^{n+1}d^k$일 때 발생하는 stress ${}^{n+1}\sigma^k$를 계산해야 한다.

이 떄, ${}^{n+1}\sigma^k = {}^{n}\sigma + \Delta \sigma$이고, ${}^{n}d$과 ${}^{n}\sigma$는 이미 알고 있는 값임으로 $\Delta \epsilon = B({}^{n+1}d^k - {}^{n}d)$가 주어졌을 때, $\Delta \sigma$가 얼마인지 구하면 된다.

이 때, $\Delta \sigma$ 계산은 hardening model에 따라 달라진다.

### Isotropic Hardening Model
${}^{n+1}\sigma$을 구하기 위해 다음 과정을 거친다.

#### 1. Compute the current yield stress
$n$번째 load increment까지의 plastic strain을 ${}^n\epsilon_p$, plastic modulus $H$, initial yield stress를 ${}^0\sigma_Y$라 하자.

${}^n\epsilon_p$, $H$, ${}^0\sigma_Y$가 주어졌을 때, 다음이 성립한다.
$$ {}^n\sigma_Y = {}^0\sigma_Y + H{}^n\epsilon_p  $$

#### 2. Elasticity assumption
$\Delta \epsilon$가 더해진 후에도 elastic영역이여서 $\Delta \epsilon_p = 0$이라 가정하자.

$\Delta \epsilon = \Delta \epsilon_e$임으로 다음이 성립한다.
$$ \Delta \sigma = E \Delta \epsilon $$

따라서 elasticity 가정에 의한  trial stress는 다음과 같다.
$$ {}^{tr}\sigma = {}^n\sigma + \Delta \sigma $$

#### 3. Check yield condition
이 때, elasticity 가정이 옳바른지 판단하기 위해 yield condition을 이용한다.

yield condition은 stress가 yield stress보다 항상 작거나 같아야 한다는 조건이다. 
$$ |\sigma| \le \sigma_Y $$

즉, elasticity assumption이 참이 되기 위해서는 다음이 성립해야한다.
$$ |{}^{tr}\sigma| \le {}^{n+1}\sigma_Y $$

이 때, elasticity assumption에 의해 다음이 성립한다.
$$ {}^{n+1}\sigma_Y = {}^{n}\sigma_Y $$

따라서, 다음이 성립해야 한다.
$$ \begin{equation} |{}^{tr}\sigma| \le {}^{n}\sigma_Y \end{equation} $$

식(1)이 성립하는 경우 elastic assumption은 참이 되고, stress는 다음과 같다.
$${}^{n+1}\sigma = {}^{tr}\sigma$$

#### 4. Plastic correction term
식(1)이 성립하지 않는 경우 ealstic assumption은 거짓이 되고 이는 $\Delta \epsilon_p \neq 0$이 된다. 

따라서 plastic strain에 대한 correction이 필요하게 된다. plastic strain에 의한 strain-hardening 현상을 고려한 correction term $\sigma_c$는 다음과 같다.
$$ \sigma_c = -\text{sgn}({}^{tr}\sigma) E \Delta\epsilon_p $$

trial stress에 plastic strain increment의 영향을 반영하기 때문에 `plastic corrector`라고하며, trial stress에서 yield stress로 돌아온다는 의미에서 `return-mapping`이라고 한다.

따라서 stress는 다음과 같다.
$$ \begin{equation} {}^{n+1}\sigma = {}^{tr}\sigma -\text{sgn}({}^{tr}\sigma) E \Delta\epsilon_p \end{equation} $$

#### 5. Plastic consistency condition
이 때, 식(2)의 $\Delta\epsilon_p$을 계산하기 위해 plastic consistency condition을 이용한다.

plastic consistency condition은 plastic phase라면, stress가 yield stress여야 한다는 조건이다. 
$$ |\sigma| = \sigma_Y $$

즉, 다음이 성립한다.
$$ \begin{aligned} & |{}^{tr}\sigma + \sigma_c| = {}^n\sigma_Y + H\Delta\epsilon_p \\ \Leftrightarrow \enspace & |{}^{tr}\sigma -\text{sgn}({}^{tr}\sigma) E \Delta\epsilon_p | = {}^n\sigma_Y + H\Delta\epsilon_p \\ \Leftrightarrow \enspace & |{}^{tr}\sigma| - E \Delta\epsilon_p  = {}^n\sigma_Y + H\Delta\epsilon_p \\ \Leftrightarrow \enspace & \Delta\epsilon_p = \frac{|{}^{tr}\sigma| - {}^n\sigma_Y}{H+E} \end{aligned}$$

따라서 stress는 다음과 같다.
$${}^{n+1}\sigma = {}^{tr}\sigma -\text{sgn}({}^{tr}\sigma) \frac{E}{H+E}(|{}^{tr}\sigma| - {}^n\sigma_Y) $$

위 식을 $\Delta\epsilon$으로 나타내기 위해 아래 그림을 고려해보자.

<p align = "center">
<img src = "./image/2022.09.16_3.png">
</p>

위 그림과 같이 $\Delta \epsilon$중 순수하게 elastic 변형만 나타나는 부분의 비율을 $R$이라 하자.

$\triangle abc \sim \triangle dec$에 의해 다음이 성립한다.
$$ \begin{aligned} & \frac{(1-R)\Delta \epsilon}{\Delta \epsilon} = \frac{|{}^{tr}\sigma| - {}^{n}\sigma_Y}{|{}^{tr}\sigma - {}^{n}\sigma|} \\ \Leftrightarrow \enspace &  R = 1 - \frac{|{}^{tr}\sigma| - {}^{n}\sigma_Y}{|{}^{tr}\sigma - {}^{n}\sigma|} \end{aligned} $$

이를 활용하면 다음이 성립한다.
$$ \begin{aligned} {}^{n+1}\sigma &= {}^{tr}\sigma -\text{sgn}({}^{tr}\sigma)\frac{E}{H+E}(|{}^{tr}\sigma| - {}^n\sigma_Y) \\ &=  {}^{tr}\sigma -\text{sgn}({}^{tr}\sigma) \frac{E(1-R)}{H+E} |{}^{tr}\sigma - {}^{n}\sigma| \\ &= {}^{tr}\sigma -\text{sgn}({}^{tr}\sigma) \frac{E^2(1-R)}{H+E} |\Delta \epsilon| \end{aligned} $$

## Tangent stiffness matrix calculation
Stress calculation 과정에서 구한 elastoplastic tangent modulus를 `algorithmic tangent modulus` $D^\text{alg}$라고 한다.

식(2)를 이용해서 $D^\text{alg}$을 계산하면 다음과 같다.
$$ \begin{aligned} D^\text{alg} &= \frac{\partial \Delta \sigma}{\partial \Delta \epsilon} \\&= \frac{\partial {}^{n+1}\sigma}{\partial \Delta \epsilon} - \frac{\partial {}^{n}\sigma}{\partial \Delta \epsilon} \\&= \frac{\partial {}^{n+1}\sigma}{\partial \Delta \epsilon} \\&= \frac{\partial {}^{tr}\sigma}{\partial \Delta \epsilon} -\text{sgn}({}^{tr}\sigma) E \frac{\partial \Delta\epsilon_p}{\partial \Delta \epsilon} \end{aligned} $$

$\Delta\epsilon_p = 0$일 때, $D^\text{alg}$는 다음과 같다.
$$ D^\text{alg} = E $$

$\Delta\epsilon_p \neq 0$일 때, $\frac{\partial \Delta\epsilon_p}{\partial \Delta \epsilon}$는 다음과 같다.
$$ \begin{aligned} \frac{\partial \Delta\epsilon_p}{\partial \Delta \epsilon} &= \frac{1}{E + H} \frac{\partial}{\partial \Delta \epsilon} \Big( |{}^{tr}\sigma| - {}^{n}\sigma_Y \Big) \\&= \frac{1}{E + H} \frac{\partial}{\partial \Delta \epsilon} \Big( |{}^{n}\sigma + E \Delta \epsilon| - {}^{n}\sigma_Y \Big) \\ &=  \frac{E}{E + H} \text{sgn}({}^{tr}\sigma) \end{aligned} $$

따라서, $\Delta\epsilon_p \neq 0$일 때, $D^\text{alg}$는 다음과 같다.
$$ D^\text{alg} = E - \frac{E^2}{E + H} = E_t $$









---
---

# Stress Increment
Elastoplastic analysis에서 중요한것은 strain increment가 주어졌을 때, stress increment를 찾는것이다.

# Nonlinear FEA Procedure
정적 평형 문제의 경우 지배방정식을 다음과 같은 Nonlinear algebraic equations으로 표현할 수 있다.
$$ R(\mathbf d) = 0 $$

$$ \text{Where, } R(\mathbf d) = \int_{\Omega} \mathbf B^T \boldsymbol\sigma_v \thinspace dV  - \int _{\partial\Omega} \mathbf N^T \mathbf t \thinspace dS - \int _{\Omega} \mathbf N^T \mathbf f \thinspace dV $$

이 떄, $R$을 residual이라고 부른다.

Nonlinear algebraic equations은 Newton-Raphson method를 이용해서 풀 수 있다.
1. 초기 해 $\mathbf d^0$를 예측하고 $n=0$으로 둔다.
2. $\mathbf d^n$에서 $R$를 선형근사한다.
$$ y= J_R(\mathbf d^n)(\mathbf d - \mathbf d^n) + R(\mathbf d^n) $$
3. 선형근사한 함수의 해 $\mathbf d^{n+1}$을 찾는다.
$$ \mathbf d^{n+1} = \mathbf d^n - J_R(\mathbf d^n)^{-1}R(\mathbf d^n)$$
4. $\mathbf d^{n+1}$이 수렴 조건을 만족하는지 확인한다.
$$ R(\mathbf d^{n+1}) \le \epsilon \enspace \land \enspace N \le n + 1  $$   
5. 만족하지 않는 경우 $n = n +1$로 두고 과정2로 돌아간다.



---

material nonlinearity만 고려하면 residual은 다음과 같이 간단해진다.
$$ R(\mathbf d) \approx \Big( \int_{\Omega} \mathbf B^T \mathbf D^{ep} \mathbf B \thinspace dV \Big) \mathbf d  - \int _{\partial\Omega} \mathbf N^T \mathbf t \thinspace dS - \int _{\Omega} \mathbf N^T \mathbf f \thinspace dV $$

Nonlinear algebraic equations은 Newton-Raphson method를 이용해서 풀 수 있다.
1. 초기 해 $\mathbf d^0$를 예측하고 $n=0$으로 둔다.
2. $\mathbf d^n$에서 $R$를 선형근사한다.
$$ y= J_R(\mathbf d^n)(\mathbf d - \mathbf d^n) + R(\mathbf d^n) $$

$$ J_R(\mathbf d) := \int_{\Omega} \mathbf B^T \mathbf D^{ep} \mathbf B \thinspace dV = \mathbf K_t $$
3. 선형근사한 함수의 해 $\mathbf d^{n+1}$을 찾는다.
$$ \mathbf d^{n+1} = \mathbf d^n - J_R(\mathbf d^n)^{-1}R(\mathbf d^n)$$
4. $\mathbf d^{n+1}$이 수렴 조건을 만족하는지 확인한다.
$$ R(\mathbf d^{n+1}) \le \epsilon \enspace \land \enspace N \le n + 1  $$   
5. 만족하지 않는 경우 $n = n +1$로 두고 과정2로 돌아간다.
