<p align = "center">
<img src = "./image/2022.09.16_5.png">
</p>

# FE Formulation for Elastoplasticy
다음과 같은 상황을 가정하자.
* static problem
* Small deformation assumption
* 다음 구성 방정식을 만족한다.
  $$ \sigma = D : \epsilon $$
* applied force $f$ is given

Static structural equilibrium의 FE formulation은 다음과 같다.
$$ \int_\Omega B^T\sigma \thinspace dV - f = 0 $$

구성 방정식과 Small deformation이라 가정에 의해 다음이 성립한다.
$$ \Big( \int_\Omega B^T DB \thinspace dV \Big) d - F = 0 $$

$R(d)$를 다음과 같이 정의한다.
$$R(d) := K_t d - {}^{n+1}F$$

$$ \text{Where, } K_t := \int_\Omega B^T D B \thinspace dV $$

이 때, $K_t$를 `tangent stiffness matrix`라고 한다.

$R(d) = 0$을 풀기 위해 Newton-Raphson method를 적용한다.
1. $k=0$으로 두고 초기 해 $d_0$를 예측한다
2. $d_k$에서 $f$를 선형근사한다.
$$ y= K_t(x - d_k) + f(d_k) $$
3. 선형근사한 함수의 해를 $d_{k+1}$로 둔다.
$$ d_{k+1} = d_k - K_t^{-1} f(d_k) $$
4. $d_{k+1}$이 convergence criterion을 만족하는지 확인한다.
$$ |f(d_{k+1})| \le \epsilon \enspace \land \enspace N \le k+1    $$
5. Convergence criterion을 만족하면 $d = d_{k+1}$로 두고 알고리즘을 끝낸다.
6. Convergence criterion을 만족하지 않는다면 $k = k + 1$로 두고 step2로 돌아간다.

# Plastic Consistency Parameter
Combined hardening model이 적용된 Von Mises yield function $f$가 주어졌다고 하자.
$$ f(\sigma, \alpha, \epsilon_e^p) = \lVert \tilde\sigma - \alpha \rVert - \sqrt{\frac{2}{3}}k(\epsilon_e^p) $$

Plastic state에서는 yield surface에 머물러 있어야 함으로 plastic state에서는 다음이 성립한다.
$$ \begin{aligned} & \frac{\partial f}{\partial t} = 0 \\ \Rightarrow \enspace & \frac{\partial f}{\partial \sigma} \frac{\partial \sigma}{\partial t} + \frac{\partial f}{\partial \alpha} \frac{\partial \alpha}{\partial t} + \frac{\partial f}{\partial \epsilon_e^p} \frac{\partial \epsilon_e^p}{\partial t} = 0 \end{aligned}  $$



# Tangent Stiffness Matrix
Combined hardening model이 적용된 Von Mises yield function $f$가 주어졌다고 하자.
$$ f(\sigma, \alpha, \epsilon_e^p) = \lVert \tilde\sigma - \alpha \rVert - \sqrt{\frac{2}{3}}k(\epsilon_e^p) $$

$$ f(\sigma, \xi) = 0 $$


Elastoplasticy 재료 이기 때문에 $D$는 비선형