# FE Formulation for Elastoplasticy
다음과 같은 상황을 가정하자.
* static problem
* Small deformation assumption
* 다음 구성 방정식을 만족한다.
  $$ \sigma = C : \epsilon $$
* applied force $f$ is given

Static structural equilibrium의 FE formulation은 다음과 같다.
$$ \int_\Omega B^T\sigma \thinspace dV - f = 0 $$

구성 방정식과 Small deformation이라 가정에 의해 다음이 성립한다.
$$ \Big( \int_\Omega B^T CB \thinspace dV \Big) d - f = 0 $$

$R(d)$를 다음과 같이 정의한다.
$$R(d) := K_t d - f$$

$$ \text{Where, } K_t := \int_\Omega B^T D B \thinspace dV $$

이 때, $K_t$를 `tangent stiffness matrix`라고 한다.

$R(d) = 0$을 풀기 위해 Newton-Raphson method를 적용한다.
1. $k=0$으로 두고 초기 해 $d_0$를 예측한다
2. $d_k$에서 $f$를 선형근사한다.
$$ y= K_t(x - d_k) + R(d_k) $$
3. 선형근사한 함수의 해를 $d_{k+1}$로 둔다.
$$ d_{k+1} = d_k - K_t^{-1} R(d_k) $$
4. $d_{k+1}$이 convergence criterion을 만족하는지 확인한다.
$$ |R(d_{k+1})| \le \epsilon \enspace \land \enspace N \le k+1    $$
5. Convergence criterion을 만족하면 $d = d_{k+1}$로 두고 알고리즘을 끝낸다.
6. Convergence criterion을 만족하지 않는다면 $k = k + 1$로 두고 step2로 돌아간다.
