# FE Formulation for Elastoplasticy
Equilibrium state일 때, momentume equation의 displacement based FE formulation은 다음과 같다.
$$ \int_\Omega B^T\sigma(d) \thinspace dV = f $$

$R(d)$를 다음과 같이 정의한다.
$$R(d) := \int_\Omega B^T\sigma(d) \thinspace dV - f$$

$R(d) = 0$을 풀기 위해 Newton-Raphson method를 적용한다.
1. $k=0$으로 두고 초기 해를 예측한다
$$ {}^{k}d = 0, {}^{k}\sigma = 0 $$
2. $d_k$에서 $R$를 선형근사한다.
$$ y= J_R(x - {}^{k}d) + R({}^{k}d) $$
3. 선형근사한 함수의 해를 ${}^{k+1}d$로 두고 행렬식을 풀어 $\Delta d$를 구한다.
$$ \begin{aligned} J_R({}^{k+1}d - {}^{k}d) &= -R({}^{k}d) \\ J_R \Delta d &= -R({}^{k}d) \end{aligned}  $$
4. stress calculation algorithm을 통해 $\sigma({}^{k+1}d) =\sigma({}_{n}\sigma, \Delta d)$을 계산하고 $R({}^{k+1}d)$을 계산한다.
5. $R({}^{k+1}d)$이 convergence criterion을 만족하는지 확인한다.
$$ |R(d_{k+1})| \le \epsilon \enspace \land \enspace N \le k+1    $$
6. Convergence criterion을 만족하면 $d = d_{k+1}$로 두고 알고리즘을 끝낸다.
7. Convergence criterion을 만족하지 않는다면 $k = k + 1$로 두고 step2로 돌아간다.
