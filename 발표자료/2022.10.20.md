# Assumption
1. small deformation
2. Equilibrium state 
3. J2 plasticity model with combined hardening model을 사용한다.
4. ${}^{n}d, {}^{n}\sigma, {}^{n}\alpha, {}^{n}\epsilon_e^p$을 알고 있다.
5. Incremental force method를 적용하여, $n$ step까지 수렴했다.

# Algorithm for Elastoplasticy
$n+1$ step의 displacement based FE formulation은 다음과 같다.
$$ \int_\Omega B^T\sigma(d) \thinspace dV = f^{n+1} $$

$R(d)$를 다음과 같이 정의한다.
$$R(d) := \int_\Omega B^T\sigma(d) \thinspace dV - f^{n+1}$$

$R(d) = 0$을 풀기 위해 Newton-Raphson method와 stress calculation algorithm을 사용한다.
1. $k=0$으로 두고 초기값들을 설정한다.
    $$ \begin{aligned} d^k &= {}^{n}d \\ \sigma^k &= {}^{n}\sigma \\ \Delta d^k &= 0 \\ R(d^k) &= \int_\Omega B^T\sigma^k \thinspace dV - f^{n+1} \end{aligned}  $$
2. $d_k$에서 $R$를 선형근사한다.
$$ y= J_R(x - d^k) + R(d^k) $$
3. 선형근사한 함수의 해를 $d^{k + 1}$로 두고 행렬식을 풀어 $\Delta d$를 구한다.
$$ \begin{aligned} J_R(d^{k + 1} - d^k) &= -R(d^k) \\ J_R \Delta d &= -R(d^k) \end{aligned}  $$
4. $\Delta d$와 $d$를 업데이트 한다.
   $$ \begin{aligned} \Delta d^{k+1} &= \Delta d^k + \Delta d \\ d^{k+1} &= d^k + \Delta d \end{aligned}  $$
5. Stress calculation algorithm을 통해 $\sigma^{k + 1}, \alpha^{k + 1}, (\epsilon_e^p)^{k + 1}$를 계산한다.
   $$ \{ \sigma^{k + 1}, \alpha^{k + 1}, (\epsilon_e^p)^{k + 1} \} = f({}^{n}\sigma, {}^{n}\alpha, {}^{n}\epsilon_e^p, \Delta d^{k+1}) $$
6. $R(d^{k + 1})$을 계산한다.
   $$ R(d^{k+1}) = \int_\Omega B^T\sigma^{k + 1} \thinspace dV - f^{n+1} $$
7. $R(d^{k + 1})$이 convergence criterion을 만족하는지 확인한다.
$$ |R(d_{k+1})| \le \epsilon \enspace \land \enspace N \le k+1    $$
6. Convergence criterion을 만족하면 변수들을 업데이트하고 알고리즘을 끝낸다.
   $$ \begin{aligned} {}^{n+1}d &= d^{k+1} \\ {}^{n+1}\sigma &= \sigma^{k+1} \\ {}^{n+1}\alpha &= \alpha^{k+1} \\ {}^{n+1}(\epsilon_e^p) &= (\epsilon_e^p)^{k+1} \end{aligned}  $$
7. Convergence criterion을 만족하지 않는다면 $k = k + 1$로 두고 2번으로 돌아간다.
